报表开发需求文档

(一)	报告概况	2
1.1.	分析目标：	2
1.2.	分析方法：	3
1.3.	分析标准：	3
1.4.	数据可视化：	3
(二)	数据来源	5
2.1.	数据源：	5
2.2.	字段需求：	5
2.3.	数据提取条件：	6
2.4.	计算逻辑：	6
2.5.	汇总逻辑：	7
2.6.	建立数据表：	7
2.7.	数据质量和异常处理：	7
(三)	数据整理	7
3.1.	数据提取：	8
3.2.	数据存储：	8
3.3.	数据清理和转换：	8
3.4.	数据管理：	8
3.5.	数据传递与API接口开发：	9
(四)	数据分析	9
4.1.	报表输出：	9
4.2.	展示方式：	9
4.3.	数据质量和异常处理：	10
4.4.	报表权限和安全性：	10
4.5.	可维护性和文档要求：	10
4.6.	测试和验证：	10

(一)	报告概况
报表名称：生产报表
版本：1.0
报表目的：生成一个生产报表，用于分析生产计划完成情况和成本绩效。
1.1.	分析目标：
数据分析的主要目标是深入了解生产计划完成情况和成本绩效，以帮助管理层做出明智的决策。
1.1.1.	了解生产计划完成情况：
比较计划产量与实际产量，以确定生产计划的执行情况。
分析延误情况，包括延误的时间、原因和影响范围，以识别潜在的问题和瓶颈。
1.1.2.	分析成本绩效：
研究成本与产出之间的关系，包括每单位产出的成本，成本随产量增加的变化情况等。
评估成本效益，即生产所得的产出是否能够有效地回报生产过程中的成本投入。
1.1.3.	识别潜在的改进机会：
分析生产过程中存在的效率低下或浪费现象，以发现改进的空间。
定位和评估潜在的改进机会，包括优化资源利用、改进生产流程和技术更新等方面，以提高生产计划的效率和降低成本。
1.2.	分析方法：
/
1.3.	分析标准：
分析将依据以下具体的生产计划完成情况和成本绩效标准进行：
生产计划完成情况标准：设定生产计划执行率、及时交付率、废品率等指标，以衡量生产计划的执行情况，确保生产进度和质量。
成本绩效标准：确定单位产出成本、生产效率、利润率等指标，以评估生产过程中的成本效益，优化资源配置和生产布局。
1.4.	数据可视化：
1.4.1.	数据可视化类型（图表、仪表板、仪表盘等）：
图表1：生产计划完成情况
图表名称	生产计划完成情况
图形类型	折线图
横坐标（X轴）	时间或生产周期，通常以日期为单位
纵坐标（Y轴）	生产计划完成情况，通常以百分比表示实际产出与计划产出之间的差异度量
折线	表示实际产出与计划产出之间的变化趋势，每个数据点对应一个时间点或生产周期
筛选条件：
序号	字段名	描述	是否主键
1	工厂	选择要分析的工厂	是
2	日期范围	指定报表数据的日期范围	否
3	工作中心	选择要分析的工作中心	否
4	策略组	选择要分析的策略组	否
5	其他筛选条件	其他筛选条件的描述	否
用途与价值：
这个图表旨在帮助管理团队追踪和分析生产计划执行情况，以便及时采取纠正措施确保计划按时完成，并为制定战略性决策提供可视化支持。

1.4.2.	自动化通知流程：
描述自动通知的流程，包括何时触发通知、通知的内容、通知方式等。这可以包括根据定议的通知条件自动触发通知。
序号	触发条件	通知内容	通知方式
1	条件	通知内容描述	企业微信、邮件、手机短信、语音电话、数字报表
1.4.3.	监测通知反馈
说明如何监测通知的有效性和接收情况。是否有监测和反馈机制，以便跟踪通知的投递和用户的响应？
序号	监测项	描述
1	监测通知投递	监测系统是否成功将通知发送至接收方，包括成功和失败的通知。
2	监测用户响应	跟踪用户对通知的响应，如用户是否已经查看通知、是否已经采取行动。
3	定议监测时间间隔	规定监测的时间间隔，如每日、每周或每月，以确保及时性。
4	监测报告和分析	如何生成监测报告和分析，以便识别通知的效果和改进机会。
1.4.4.	紧急通知策略
定义在紧急情况下如何处理通知，包括谁负责发出紧急通知、通知的内容、通知的接收者等。紧急通知策略可确保在需要时采取迅速而有效的行动。
序号	紧急通知策略内容	描述
1	通知发出负责人	定义在紧急情况下，谁负责发出紧急通知，通常是特定的责任人或团队。
2	通知的内容	紧急通知的具体内容，包括何时触发通知、通知的目的、必要的行动等信息。
3	通知接收者	规定谁应该接收紧急通知，通常包括相关的管理人员、团队成员或其他关键利益相关者。
4	紧急通知方式	定义紧急通知的传递方式，可以包括企业微信、企业邮箱、手机短信、语音电话等多种方式。
5	紧急通知流程	描述在紧急情况下，紧急通知的自动化流程，包括触发条件、通知负责人、通知内容、通知接收者等。

1.4.5.	通知接收范围
指明通知将发送给谁，包括具体的接收者、接收者的角色和职责。
序号	通知接收范围	描述
1	接收者	列出将接收通知的具体个人或团队，包括他们的姓名和联系信息。
2	接收者角色	标明每个接收者的角色或职责，以便清晰地了解他们在通知接收中的作用。
3	通知内容定制	描述通知接收者是否会收到定制的通知内容，以满足其特定的需求或角色。

(二)	数据来源
2.1.	数据源：
提取SAP系统的以下表原始数据并存储至公司数据湖对应目录：
序号	数据表名称	描述
1	AFRU	描述表AFRU的用途。
2	AFPO	描述表AFPO的用途。
3	AFKO	描述表AFKO的用途。
4	AFVC	描述表AFVC的用途。
5	CRHD	描述表CRHD的用途。
6	VBAP	描述表VBAP的用途。
7	VBKD	描述表VBKD的用途。
8	MBEW	描述表MBEW的用途。
9	MBEWH	描述表MBEWH的用途。
2.2.	字段需求：
序号	表名	字段名	描述
1	VBAP	VBELN	销售订单编号
2		POSNR	销售订单行项目
3		NETPR	净价
4		KURSK	汇率
5		KPEIN	计价单位
6	VBKD	VBELN	销售订单编号
7		POSNR	销售订单行项目
8		KURSK	汇率
9	MBEW	STPRS	标准价格
10		VERPR	移动平均价格
11		PEINH	价格单位换算
12		VPRSV	价格控制指示
13	MBEWH	STPRS	标准价格
14		VERPR	移动平均价格
15		PEINH	价格单位换算
16		VPRSV	价格控制指示
2.3.	数据提取条件：
序号	提取条件	表格/字段	数据来源	取数条件	计算条件
1	基本条件	AFRU	数据湖	AUFNR=AFPO-AUFNR	
2				AUFNR=AFKO-AUFNR	
3				RUECK=AFVC-RUECK	
4	KDAUF不为空的情况	VBAP	数据湖	KDAUF=VBAP-VBELNAND(KDPOS=VBAP-POSNRORVBKD-POSNR='00000')	NETPR*KDPOS*KURSK/KPEIN
5	KDAUF为空的情况	MBEW	数据湖	MATNR=A.MATNRANDBWKEY=A.WERKSAND(VPRSV='S'ORVPRSV='V')	STPRS/PEINH
6	从MBEW中未提取到数据的情况	MBEWH	数据湖	MATNR=A.MATNRANDBWKEY=A.WERKSANDLFGJA=YEAR(BUDAT)ANDLFMON=MONTH(BUDAT)AND(VPRSV='S'ORVPRSV='V')	STPRS/PEINH
2.4.	计算逻辑：
序号	计算项目	判断条件	计算公式
1	单价	如果表A中的KDAUF不为空	单价=(VBAP-NETPR*VBKD-KURSK)/VBAP-KPEIN
2		如果表A中的KDAUF为空	
		-如果MBEW-VPRSV='S'	单价=MBEW-STPRS/MBEW-PEINH
		-如果MBEW-VPRSV='V'：	单价=MBEW-VERPR/MBEW-PEINH
3		否则	单价=未定义
2.5.	汇总逻辑：
序号	汇总项目	汇总方法
1	总产值	总产值=单价*GMNGA

2.6.	建立数据表：
为了实现报表的数据组织和存储，我们将数据清洗整理后存储至对应数据仓库并建立一个名为"表A"的数据表。此表将采用以下字段，以确保报表的清晰结构和数据准确性：
序号	字段名	描述	类型	长度
1	WERKS	工厂		
2	BUDAT	日期		
3	ARBPL	工作中心		
4	STRGR	策略组		
5	GMNGA	生产数量		
6	单价	单价		
7	总产值	产值总计		
8	KTEXT	文本描述		
9	ERSDA	记录创建日期		
10	STEGE	状态码（'60'或'63'）		

2.7.	数据质量和异常处理：
序号	数据质量验证与异常处理	时间点	负责人	问题描述和解决方案
1	数据提取前数据预检	每次数据提取前	数据分析师	检查数据完整性，发现问题后协助解决。
2	数据清理与转换	数据提取后	数据分析师	清理重复数据，填充缺失数据，处理异常数据。
3	异常数据记录和通知	数据清理与转换后	数据分析师	记录异常数据并通知相关人员。
4	数据备份	每次数据提取后	数据分析师	定期备份数据以应对数据丢失或损坏。
(三)	数据整理
3.1.	数据提取：
序号 	       事件       	               描述               
  1   	 数据采集规则   	 定时规则，如每日、每周或每月  
  2   	 数据采集频率   	根据业务需求和数据的变化，定期采集，并确保数据按计划进行。
  3   	 数据采集方法   	使用的工具或脚本，例如SQL查询
3.2.	数据存储：
原则上提取到的数据存储到数据湖对应库表，数据表结构与字段描述要保持一致。如果原始数据过大可考虑拆分。
序号	来源	表名	描述	数据湖	对应表
1	SAP HANA	AFRU	生产订单号		
2	SAP HANA	AFPO	生产订单号		
3	SAP HANA	AFKO	生产订单号		
4	SAP HANA	AFVC	工序计数		
5	SAP HANA	CRHD	控制键		
6	SAP HANA	VBAP	销售订单号		
3.3.	数据清理和转换：
依据业务需要进行数据清理和转换并存储至对应数据仓。
序号	数据清理规则	数据清理方法
1	数据去噪	基于统计方法检测异常值，如标准差方法、箱线图方法。根据异常值的程度选择删除、替换或保留。
2	数据去重	通过唯一值去重或识别重复记录的字段，并删除多余的重复记录。
3	数据标准化	使用函数或脚本将不同格式的数据字段统一到一致的格式，如日期格式化、货币符号去除、单位转换等。
4	缺失数据处理	填充缺失数据可采用平均值、中位数、众数等统计方法，或插值法。删除缺失数据行可根据情况选择。
5	异常值处理	基于阈值或规则进行异常值的检测和处理，包括删除、替换为平均值或中位数等。
6	数据合并和拆分	使用合使用合并函数或SQL操作将多个数据集合并，或根据字段条件拆分数据集。
3.4.	数据管理：
序号	描述	详细信息
1	数据存储位置	数据存储在位于公司总部的数据中心服务器中。
2	数据中心位置	数据中心位于公司总部的物理地址。
3	数据库管理系统	数据存储在SAPHANA数据库，版本：SAPHANA2.0。
4	存储设备类型	使用企业级磁盘阵列，总容量：10TB。
5	备份策略	定期每天执行全备份，备份到云存储服务（AWS）。每周执行差异备份和每月执行归档备份。
6	数据访问权限	实施严格的身份验证，使用单一登录系统。访问权限根据员工角色分配，审计数据访问记录。
3.5.	数据传递与API接口开发：
序号	任务	详细描述及操作步骤
1	数据传递至数据仓	将数据湖数内指定数据，传递至对应数据仓，确保数据的实时性和可用性。
2	数据传递标准	数据传递需按照预定的定时规则进行，通常是每日、每周或每月的特定时间点，以确保数据的定期更新和实时性。
3	API接口开发	创建API接口，以便其他团队和应用程序可以通过API访问和检索数据。API接口必须提供适当的身份验证和授权机制，以确保数据的安全性和完整性。
4	安全性	实施数据传递和API接口的安全性措施，包括数据加密和身份验证，以确保数据的保密性和完整性。

(四)	数据分析
4.1.	报表输出：
用户将能够通过Web界面访问报表，通过相关筛选条件参数来生成自定义报表。
4.2.	报表权限和安全性：
报表将实施访问权限控制，只有授权用户才能查看和生成报表。敏感数据将受到保护。
序号	用户角色	可访问的报表内容
1	管理员	所有报表内容，包括敏感数据的访问和生成权限。
2	数据负责人	特定报表内容，可以访问和生成与其负责的数据相关的报表。
3	生产团队成员	有限的报表内容，可用于查看与其工作任务相关的数据。
4	其它用户组	仅有极少的报表内容，通常只包括非敏感和公开的数据。
4.3.	可维护性和文档要求：
开发人员将提供清晰的代码注释，并编写技术文档，以支持未来的维护和更新。
4.4.	测试和验证：
报表开发将经历单元测试、集成测试和验证，以确保其正确性和可靠性。
序号	要求类型	描述
1	单元测试	报表开发人员应进行单元测试，以验证代码的正确性。
2	集成测试	报表应在测试环境中进行集成测试，以确保各个组件协同工作。
3	验证	报表应通过验证过程，与用户需求和业务规则进行比对，以确保其满足要求。
4	异常处理	报表应包括异常处理机制，以处理数据提取和处理中的异常情况。
